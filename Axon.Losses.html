<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.25.3">
    <meta name="project" content="Axon v0.1.0-dev">

    <title>Axon.Losses â€” Axon v0.1.0-dev</title>
    <link rel="stylesheet" href="dist/elixir-37545fd2f35b96531434.css" />

    <script src="dist/sidebar_items-09e55d8436.js"></script>

      <script src="docs_config.js"></script>

    <script async src="dist/app-e5e774c81fa6257aba7f.js"></script>


  </head>
  <body data-type="modules">
    <script>

      try {
        if (localStorage.getItem('night-mode') === 'true') {
          document.body.classList.add('night-mode');
        }
      } catch (error) { }
    </script>

<div class="main">

<button class="sidebar-button sidebar-toggle">
  <span class="icon-menu" title="Collapse/expand sidebar"></span>
</button>

<section class="sidebar">
  <form class="sidebar-search" action="search.html">
    <button type="submit" class="search-button" aria-label="Submit Search">
      <span class="icon-search" aria-hidden="true" title="Submit search"></span>
    </button>
    <button type="button" tabindex="-1" class="search-close-button" aria-label="Cancel Search">
      <span class="icon-cross" aria-hidden="true" title="Cancel search"></span>
    </button>
    <label class="search-label">
      <input name="q" type="text" class="search-input" placeholder="Search..." aria-label="Input your search terms" autocomplete="off" />
    </label>
  </form>

  <div class="autocomplete">
    <div class="autocomplete-results">
    </div>
  </div>

  <div class="sidebar-header">
    <div class="sidebar-projectDetails">
      <a href="Axon.html" class="sidebar-projectName">
Axon
      </a>
      <strong class="sidebar-projectVersion">
        v0.1.0-dev
      </strong>
    </div>

  </div>

  <ul class="sidebar-listNav">
    <li><a id="extras-list-link" href="#full-list">Pages</a></li>

      <li><a id="modules-list-link" href="#full-list">Modules</a></li>


  </ul>
  <div class="gradient"></div>
  <ul id="full-list" class="sidebar-fullList"></ul>
</section>

<section class="content">
  <div class="content-outer">
    <div id="content" class="content-inner">

      <h1>
Axon.Losses <small class="app-vsn">(Axon v0.1.0-dev)</small>

          <a href="https://github.com/elixir-nx/axon/blob/v0.1.0-dev/lib/axon/losses.ex#L1" title="View Source" class="view-source" rel="help">
            <span class="icon-code" aria-hidden="true"></span>
            <span class="sr-only">View Source</span>
          </a>

      </h1>


        <section id="moduledoc">
<p>Loss functions.</p><p>Loss functions evaluate predictions with respect to true
data, often to measure the divergence between a model's
representation of the data-generating distribution and the
true representation of the data-generating distribution.</p><p>Each loss function is implemented as an element-wise function
measuring the loss with respect to the input target <code class="inline">y_true</code>
and input prediction <code class="inline">y_pred</code>. As an example, the <a href="#mean_squared_error/2"><code class="inline">mean_squared_error/2</code></a>
loss function produces a tensor whose values are the mean squared
error between targets and predictions:</p><pre><code class="makeup elixir"><span class="gp unselectable">iex&gt; </span><span class="n">y_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="8614924821-1">(</span><span class="p" data-group-id="8614924821-2">[</span><span class="p" data-group-id="8614924821-3">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p" data-group-id="8614924821-3">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8614924821-4">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p" data-group-id="8614924821-4">]</span><span class="p" data-group-id="8614924821-2">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="8614924821-5">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="8614924821-5">}</span><span class="p" data-group-id="8614924821-1">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="8614924821-6">(</span><span class="p" data-group-id="8614924821-7">[</span><span class="p" data-group-id="8614924821-8">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p" data-group-id="8614924821-8">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8614924821-9">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p" data-group-id="8614924821-9">]</span><span class="p" data-group-id="8614924821-7">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="8614924821-10">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="8614924821-10">}</span><span class="p" data-group-id="8614924821-6">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p" data-group-id="8614924821-11">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p" data-group-id="8614924821-11">)</span><span class="w">
</span><span class="p" data-group-id="8614924821-12">#</span><span class="nc" data-group-id="8614924821-12">Nx.Tensor</span><span class="p" data-group-id="8614924821-12">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="p" data-group-id="8614924821-13">[</span><span class="mi">2</span><span class="p" data-group-id="8614924821-13">]</span><span class="w">
  </span><span class="p" data-group-id="8614924821-14">[</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p" data-group-id="8614924821-14">]</span><span class="w">
</span><span class="p" data-group-id="8614924821-12">&gt;</span></code></pre><p>It's common to compute the loss across an entire minibatch.
You can easily do so by specifying a <code class="inline">:reduction</code> mode, or
by composing one of these with an <a href="https://hexdocs.pm/nx/0.1.0-dev/Nx.html"><code class="inline">Nx</code></a> reduction method:</p><pre><code class="makeup elixir"><span class="gp unselectable">iex&gt; </span><span class="n">y_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="9014188131-1">(</span><span class="p" data-group-id="9014188131-2">[</span><span class="p" data-group-id="9014188131-3">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p" data-group-id="9014188131-3">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9014188131-4">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p" data-group-id="9014188131-4">]</span><span class="p" data-group-id="9014188131-2">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="9014188131-5">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="9014188131-5">}</span><span class="p" data-group-id="9014188131-1">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="9014188131-6">(</span><span class="p" data-group-id="9014188131-7">[</span><span class="p" data-group-id="9014188131-8">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p" data-group-id="9014188131-8">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9014188131-9">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p" data-group-id="9014188131-9">]</span><span class="p" data-group-id="9014188131-7">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="9014188131-10">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="9014188131-10">}</span><span class="p" data-group-id="9014188131-6">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p" data-group-id="9014188131-11">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p">,</span><span class="w"> </span><span class="ss">reduction</span><span class="p">:</span><span class="w"> </span><span class="ss">:mean</span><span class="p" data-group-id="9014188131-11">)</span><span class="w">
</span><span class="p" data-group-id="9014188131-12">#</span><span class="nc" data-group-id="9014188131-12">Nx.Tensor</span><span class="p" data-group-id="9014188131-12">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="w">
  </span><span class="mf">0.5</span><span class="w">
</span><span class="p" data-group-id="9014188131-12">&gt;</span></code></pre><p>You can even compose loss functions:</p><pre><code class="makeup elixir"><span class="kd">defn</span><span class="w"> </span><span class="nf">my_strange_loss</span><span class="p" data-group-id="1552653413-1">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p" data-group-id="1552653413-1">)</span><span class="w"> </span><span class="k" data-group-id="1552653413-2">do</span><span class="w">
  </span><span class="n">y_true</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p" data-group-id="1552653413-3">(</span><span class="n">y_pred</span><span class="p" data-group-id="1552653413-3">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">binary_cross_entropy</span><span class="p" data-group-id="1552653413-4">(</span><span class="n">y_pred</span><span class="p" data-group-id="1552653413-4">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">sum</span><span class="p" data-group-id="1552653413-5">(</span><span class="p" data-group-id="1552653413-5">)</span><span class="w">
</span><span class="k" data-group-id="1552653413-2">end</span></code></pre><p>Or, more commonly, you can combine loss functions with penalties for
regularization:</p><pre><code class="makeup elixir"><span class="kd">defn</span><span class="w"> </span><span class="nf">regularized_loss</span><span class="p" data-group-id="8876686192-1">(</span><span class="n">params</span><span class="p">,</span><span class="w"> </span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p" data-group-id="8876686192-1">)</span><span class="w"> </span><span class="k" data-group-id="8876686192-2">do</span><span class="w">
  </span><span class="n">loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p" data-group-id="8876686192-3">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p" data-group-id="8876686192-3">)</span><span class="w">
  </span><span class="n">penalty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l2_penalty</span><span class="p" data-group-id="8876686192-4">(</span><span class="n">params</span><span class="p" data-group-id="8876686192-4">)</span><span class="w">
  </span><span class="nc">Nx</span><span class="o">.</span><span class="n">sum</span><span class="p" data-group-id="8876686192-5">(</span><span class="n">loss</span><span class="p" data-group-id="8876686192-5">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">penalty</span><span class="w">
</span><span class="k" data-group-id="8876686192-2">end</span></code></pre><p>All of the functions in this module are implemented as
numerical functions and can be JIT or AOT compiled with
any supported <a href="https://hexdocs.pm/nx/0.1.0-dev/Nx.html"><code class="inline">Nx</code></a> compiler.</p>
        </section>


        <section id="summary" class="details-list">
          <h1 class="section-heading">
            <a class="hover-link" href="#summary">
              <span class="icon-link" aria-hidden="true"></span>
              <span class="sr-only">Link to this section</span>
            </a>
            Summary
          </h1>

  <div class="summary-functions summary">
    <h2>
      <a href="#functions">Functions</a>
    </h2>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#binary_cross_entropy/3">binary_cross_entropy(y_true, y_pred, opts \\ [])</a>

  </div>

    <div class="summary-synopsis"><p>Binary cross-entropy loss function.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#categorical_cross_entropy/3">categorical_cross_entropy(y_true, y_pred, opts \\ [])</a>

  </div>

    <div class="summary-synopsis"><p>Categorical cross-entropy loss function.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#categorical_hinge/3">categorical_hinge(y_true, y_pred, opts \\ [])</a>

  </div>

    <div class="summary-synopsis"><p>Categorical hinge loss function.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#hinge/3">hinge(y_true, y_pred, opts \\ [])</a>

  </div>

    <div class="summary-synopsis"><p>Hinge loss function.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#kl_divergence/3">kl_divergence(y_true, y_pred, opts \\ [])</a>

  </div>

    <div class="summary-synopsis"><p>Kullback-Leibler divergence loss function.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#log_cosh/3">log_cosh(y_true, y_pred, opts \\ [])</a>

  </div>

    <div class="summary-synopsis"><p>Logarithmic-Hyperbolic Cosine loss function.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#margin_ranking/3">margin_ranking(y_true, arg2, opts \\ [])</a>

  </div>

    <div class="summary-synopsis"><p>Margin ranking loss function.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#mean_absolute_error/3">mean_absolute_error(y_true, y_pred, opts \\ [])</a>

  </div>

    <div class="summary-synopsis"><p>Mean-absolute error loss function.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#mean_squared_error/3">mean_squared_error(y_true, y_pred, opts \\ [])</a>

  </div>

    <div class="summary-synopsis"><p>Mean-squared error loss function.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#poisson/3">poisson(y_true, y_pred, opts \\ [])</a>

  </div>

    <div class="summary-synopsis"><p>Poisson loss function.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#soft_margin/3">soft_margin(y_true, y_pred, opts \\ [])</a>

  </div>

    <div class="summary-synopsis"><p>Soft margin loss function.</p></div>

</div>

  </div>

        </section>


        <section id="functions" class="details-list">
          <h1 class="section-heading">
            <a class="hover-link" href="#functions">
              <span class="icon-link" aria-hidden="true"></span>
              <span class="sr-only">Link to this section</span>
            </a>
Functions
          </h1>
          <div class="functions-list">
<section class="detail" id="binary_cross_entropy/3">

    <span id="binary_cross_entropy/2"></span>

  <div class="detail-header">
    <a href="#binary_cross_entropy/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">binary_cross_entropy(y_true, y_pred, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.1.0-dev/lib/axon/losses.ex#L0" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Binary cross-entropy loss function.</p><p>$$l_i = -\frac{1}{2}(\hat{y_i} \cdot \log(y_i) + (1 - \hat{y_i}) \cdot \log(1 - y_i))$$</p><p>Binary cross-entropy loss is most often used in binary classification problems.
By default, it expects <code class="inline">y_pred</code> to encode probabilities from <code class="inline">[0.0, 1.0]</code>, typically
as the output of the sigmoid function or another function which squeezes values
between 0 and 1. You may optionally set <code class="inline">from_logits: true</code> to specify that values
are being sent as non-normalized values (e.g. weights with possibly infinite range).
In this case, input values will be encoded as probabilities by applying the logistic
sigmoid function before computing loss.</p><h2 id="binary_cross_entropy/3-argument-shapes" class="section-heading">
  <a href="#binary_cross_entropy/3-argument-shapes" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Argument Shapes
</h2>
<ul><li><code class="inline">y_true</code> - $(d_0, d_1, ..., d_n)$</li><li><code class="inline">y_pred</code> - $(d_0, d_1, ..., d_n)$</li></ul><h2 id="binary_cross_entropy/3-options" class="section-heading">
  <a href="#binary_cross_entropy/3-options" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Options
</h2>
<ul><li><p><code class="inline">:reduction</code> - reduction mode. One of <code class="inline">:mean</code>, <code class="inline">:sum</code>, or <code class="inline">:none</code>.
Defaults to <code class="inline">:none</code>.</p></li><li><p><code class="inline">:negative_weights</code> - class weight for <code class="inline">0</code> class useful for scaling loss
by importance of class. Defaults to <code class="inline">1.0</code>.</p></li><li><p><code class="inline">:positive_weights</code> - class weight for <code class="inline">1</code> class useful for scaling loss
by importance of class. Defaults to <code class="inline">1.0</code>.</p></li><li><p><code class="inline">:from_logits</code> - whether <code class="inline">y_pred</code> is a logits tensor. Defaults to <code class="inline">false</code>.</p></li></ul><h2 id="binary_cross_entropy/3-examples" class="section-heading">
  <a href="#binary_cross_entropy/3-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>
<pre><code class="makeup elixir"><span class="gp unselectable">iex&gt; </span><span class="n">y_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="0469449030-1">(</span><span class="p" data-group-id="0469449030-2">[</span><span class="p" data-group-id="0469449030-3">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="0469449030-3">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0469449030-4">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="0469449030-4">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0469449030-5">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="0469449030-5">]</span><span class="p" data-group-id="0469449030-2">]</span><span class="p" data-group-id="0469449030-1">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="0469449030-6">(</span><span class="p" data-group-id="0469449030-7">[</span><span class="p" data-group-id="0469449030-8">[</span><span class="mf">0.6811</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5565</span><span class="p" data-group-id="0469449030-8">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0469449030-9">[</span><span class="mf">0.6551</span><span class="p">,</span><span class="w"> </span><span class="mf">0.4551</span><span class="p" data-group-id="0469449030-9">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0469449030-10">[</span><span class="mf">0.5422</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2648</span><span class="p" data-group-id="0469449030-10">]</span><span class="p" data-group-id="0469449030-7">]</span><span class="p" data-group-id="0469449030-6">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">binary_cross_entropy</span><span class="p" data-group-id="0469449030-11">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p" data-group-id="0469449030-11">)</span><span class="w">
</span><span class="p" data-group-id="0469449030-12">#</span><span class="nc" data-group-id="0469449030-12">Nx.Tensor</span><span class="p" data-group-id="0469449030-12">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="p" data-group-id="0469449030-13">[</span><span class="mi">3</span><span class="p" data-group-id="0469449030-13">]</span><span class="w">
  </span><span class="p" data-group-id="0469449030-14">[</span><span class="mf">0.8644826412200928</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5150600075721741</span><span class="p">,</span><span class="w"> </span><span class="mf">0.45986634492874146</span><span class="p" data-group-id="0469449030-14">]</span><span class="w">
</span><span class="p" data-group-id="0469449030-12">&gt;</span><span class="w">

</span><span class="gp unselectable">iex&gt; </span><span class="n">y_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="0469449030-15">(</span><span class="p" data-group-id="0469449030-16">[</span><span class="p" data-group-id="0469449030-17">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="0469449030-17">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0469449030-18">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="0469449030-18">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0469449030-19">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="0469449030-19">]</span><span class="p" data-group-id="0469449030-16">]</span><span class="p" data-group-id="0469449030-15">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="0469449030-20">(</span><span class="p" data-group-id="0469449030-21">[</span><span class="p" data-group-id="0469449030-22">[</span><span class="mf">0.6811</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5565</span><span class="p" data-group-id="0469449030-22">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0469449030-23">[</span><span class="mf">0.6551</span><span class="p">,</span><span class="w"> </span><span class="mf">0.4551</span><span class="p" data-group-id="0469449030-23">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0469449030-24">[</span><span class="mf">0.5422</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2648</span><span class="p" data-group-id="0469449030-24">]</span><span class="p" data-group-id="0469449030-21">]</span><span class="p" data-group-id="0469449030-20">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">binary_cross_entropy</span><span class="p" data-group-id="0469449030-25">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p">,</span><span class="w"> </span><span class="ss">reduction</span><span class="p">:</span><span class="w"> </span><span class="ss">:mean</span><span class="p" data-group-id="0469449030-25">)</span><span class="w">
</span><span class="p" data-group-id="0469449030-26">#</span><span class="nc" data-group-id="0469449030-26">Nx.Tensor</span><span class="p" data-group-id="0469449030-26">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="w">
  </span><span class="mf">0.613136351108551</span><span class="w">
</span><span class="p" data-group-id="0469449030-26">&gt;</span><span class="w">

</span><span class="gp unselectable">iex&gt; </span><span class="n">y_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="0469449030-27">(</span><span class="p" data-group-id="0469449030-28">[</span><span class="p" data-group-id="0469449030-29">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="0469449030-29">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0469449030-30">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="0469449030-30">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0469449030-31">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="0469449030-31">]</span><span class="p" data-group-id="0469449030-28">]</span><span class="p" data-group-id="0469449030-27">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="0469449030-32">(</span><span class="p" data-group-id="0469449030-33">[</span><span class="p" data-group-id="0469449030-34">[</span><span class="mf">0.6811</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5565</span><span class="p" data-group-id="0469449030-34">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0469449030-35">[</span><span class="mf">0.6551</span><span class="p">,</span><span class="w"> </span><span class="mf">0.4551</span><span class="p" data-group-id="0469449030-35">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0469449030-36">[</span><span class="mf">0.5422</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2648</span><span class="p" data-group-id="0469449030-36">]</span><span class="p" data-group-id="0469449030-33">]</span><span class="p" data-group-id="0469449030-32">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">binary_cross_entropy</span><span class="p" data-group-id="0469449030-37">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p">,</span><span class="w"> </span><span class="ss">reduction</span><span class="p">:</span><span class="w"> </span><span class="ss">:sum</span><span class="p" data-group-id="0469449030-37">)</span><span class="w">
</span><span class="p" data-group-id="0469449030-38">#</span><span class="nc" data-group-id="0469449030-38">Nx.Tensor</span><span class="p" data-group-id="0469449030-38">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="w">
  </span><span class="mf">1.8394089937210083</span><span class="w">
</span><span class="p" data-group-id="0469449030-38">&gt;</span></code></pre>
  </section>
</section>
<section class="detail" id="categorical_cross_entropy/3">

    <span id="categorical_cross_entropy/2"></span>

  <div class="detail-header">
    <a href="#categorical_cross_entropy/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">categorical_cross_entropy(y_true, y_pred, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.1.0-dev/lib/axon/losses.ex#L0" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Categorical cross-entropy loss function.</p><p>$$l_i = -\sum_i^C \hat{y_i} \cdot \log(y_i)$$</p><p>Categorical cross-entropy is typically used for multi-class classifcation problems.
By default, it expects <code class="inline">y_pred</code> to encode a probability distribution along the last
axis. You can specify <code class="inline">from_logits: true</code> to indicate <code class="inline">y_pred</code> is a logits tensor.</p><pre><code class="makeup elixir"><span class="c1"># Batch size of 3 with 3 target classes</span><span class="w">
</span><span class="n">y_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="9523358527-1">(</span><span class="p" data-group-id="9523358527-2">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="9523358527-2">]</span><span class="p" data-group-id="9523358527-1">)</span><span class="w">
</span><span class="n">y_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="9523358527-3">(</span><span class="p" data-group-id="9523358527-4">[</span><span class="p" data-group-id="9523358527-5">[</span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p" data-group-id="9523358527-5">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9523358527-6">[</span><span class="mf">0.1</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7</span><span class="p" data-group-id="9523358527-6">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9523358527-7">[</span><span class="mf">0.1</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7</span><span class="p" data-group-id="9523358527-7">]</span><span class="p" data-group-id="9523358527-4">]</span><span class="p" data-group-id="9523358527-3">)</span></code></pre><h2 id="categorical_cross_entropy/3-argument-shapes" class="section-heading">
  <a href="#categorical_cross_entropy/3-argument-shapes" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Argument Shapes
</h2>
<ul><li><code class="inline">y_true</code> - $(d_0, d_1, ..., d_n)$</li><li><code class="inline">y_pred</code> - $(d_0, d_1, ..., d_n)$</li></ul><h2 id="categorical_cross_entropy/3-options" class="section-heading">
  <a href="#categorical_cross_entropy/3-options" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Options
</h2>
<ul><li><p><code class="inline">:reduction</code> - reduction mode. One of <code class="inline">:mean</code>, <code class="inline">:sum</code>, or <code class="inline">:none</code>.
Defaults to <code class="inline">:none</code>.</p></li><li><p><code class="inline">:class_weights</code> - 1-D list corresponding to weight of each
class useful for scaling loss according to importance of class. Tensor
size must match number of classes in dataset. Defaults to <code class="inline">1.0</code> for all
classes.</p></li><li><p><code class="inline">:from_logits</code> - whether <code class="inline">y_pred</code> is a logits tensor. Defaults to <code class="inline">false</code>.</p></li></ul><h2 id="categorical_cross_entropy/3-examples" class="section-heading">
  <a href="#categorical_cross_entropy/3-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>
<pre><code class="makeup elixir"><span class="gp unselectable">iex&gt; </span><span class="n">y_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="1724251950-1">(</span><span class="p" data-group-id="1724251950-2">[</span><span class="p" data-group-id="1724251950-3">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="1724251950-3">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1724251950-4">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="1724251950-4">]</span><span class="p" data-group-id="1724251950-2">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="1724251950-5">{</span><span class="ss">:s</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p" data-group-id="1724251950-5">}</span><span class="p" data-group-id="1724251950-1">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="1724251950-6">(</span><span class="p" data-group-id="1724251950-7">[</span><span class="p" data-group-id="1724251950-8">[</span><span class="mf">0.05</span><span class="p">,</span><span class="w"> </span><span class="mf">0.95</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="1724251950-8">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1724251950-9">[</span><span class="mf">0.1</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p" data-group-id="1724251950-9">]</span><span class="p" data-group-id="1724251950-7">]</span><span class="p" data-group-id="1724251950-6">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">categorical_cross_entropy</span><span class="p" data-group-id="1724251950-10">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p" data-group-id="1724251950-10">)</span><span class="w">
</span><span class="p" data-group-id="1724251950-11">#</span><span class="nc" data-group-id="1724251950-11">Nx.Tensor</span><span class="p" data-group-id="1724251950-11">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="p" data-group-id="1724251950-12">[</span><span class="mi">2</span><span class="p" data-group-id="1724251950-12">]</span><span class="w">
  </span><span class="p" data-group-id="1724251950-13">[</span><span class="mf">0.051293306052684784</span><span class="p">,</span><span class="w"> </span><span class="mf">2.3025851249694824</span><span class="p" data-group-id="1724251950-13">]</span><span class="w">
</span><span class="p" data-group-id="1724251950-11">&gt;</span><span class="w">

</span><span class="gp unselectable">iex&gt; </span><span class="n">y_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="1724251950-14">(</span><span class="p" data-group-id="1724251950-15">[</span><span class="p" data-group-id="1724251950-16">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="1724251950-16">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1724251950-17">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="1724251950-17">]</span><span class="p" data-group-id="1724251950-15">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="1724251950-18">{</span><span class="ss">:s</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p" data-group-id="1724251950-18">}</span><span class="p" data-group-id="1724251950-14">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="1724251950-19">(</span><span class="p" data-group-id="1724251950-20">[</span><span class="p" data-group-id="1724251950-21">[</span><span class="mf">0.05</span><span class="p">,</span><span class="w"> </span><span class="mf">0.95</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="1724251950-21">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1724251950-22">[</span><span class="mf">0.1</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p" data-group-id="1724251950-22">]</span><span class="p" data-group-id="1724251950-20">]</span><span class="p" data-group-id="1724251950-19">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">categorical_cross_entropy</span><span class="p" data-group-id="1724251950-23">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p">,</span><span class="w"> </span><span class="ss">reduction</span><span class="p">:</span><span class="w"> </span><span class="ss">:mean</span><span class="p" data-group-id="1724251950-23">)</span><span class="w">
</span><span class="p" data-group-id="1724251950-24">#</span><span class="nc" data-group-id="1724251950-24">Nx.Tensor</span><span class="p" data-group-id="1724251950-24">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="w">
  </span><span class="mf">1.1769392490386963</span><span class="w">
</span><span class="p" data-group-id="1724251950-24">&gt;</span><span class="w">

</span><span class="gp unselectable">iex&gt; </span><span class="n">y_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="1724251950-25">(</span><span class="p" data-group-id="1724251950-26">[</span><span class="p" data-group-id="1724251950-27">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="1724251950-27">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1724251950-28">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="1724251950-28">]</span><span class="p" data-group-id="1724251950-26">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="1724251950-29">{</span><span class="ss">:s</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p" data-group-id="1724251950-29">}</span><span class="p" data-group-id="1724251950-25">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="1724251950-30">(</span><span class="p" data-group-id="1724251950-31">[</span><span class="p" data-group-id="1724251950-32">[</span><span class="mf">0.05</span><span class="p">,</span><span class="w"> </span><span class="mf">0.95</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="1724251950-32">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1724251950-33">[</span><span class="mf">0.1</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p" data-group-id="1724251950-33">]</span><span class="p" data-group-id="1724251950-31">]</span><span class="p" data-group-id="1724251950-30">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">categorical_cross_entropy</span><span class="p" data-group-id="1724251950-34">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p">,</span><span class="w"> </span><span class="ss">reduction</span><span class="p">:</span><span class="w"> </span><span class="ss">:sum</span><span class="p" data-group-id="1724251950-34">)</span><span class="w">
</span><span class="p" data-group-id="1724251950-35">#</span><span class="nc" data-group-id="1724251950-35">Nx.Tensor</span><span class="p" data-group-id="1724251950-35">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="w">
  </span><span class="mf">2.3538784980773926</span><span class="w">
</span><span class="p" data-group-id="1724251950-35">&gt;</span></code></pre>
  </section>
</section>
<section class="detail" id="categorical_hinge/3">

    <span id="categorical_hinge/2"></span>

  <div class="detail-header">
    <a href="#categorical_hinge/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">categorical_hinge(y_true, y_pred, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.1.0-dev/lib/axon/losses.ex#L0" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Categorical hinge loss function.</p><h2 id="categorical_hinge/3-argument-shapes" class="section-heading">
  <a href="#categorical_hinge/3-argument-shapes" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Argument Shapes
</h2>
<ul><li><code class="inline">y_true</code> - $(d_0, d_1, ..., d_n)$</li><li><code class="inline">y_pred</code> - $(d_0, d_1, ..., d_n)$</li></ul><h2 id="categorical_hinge/3-options" class="section-heading">
  <a href="#categorical_hinge/3-options" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Options
</h2>
<ul><li><code class="inline">:reduction</code> - reduction mode. One of <code class="inline">:mean</code>, <code class="inline">:sum</code>, or <code class="inline">:none</code>.
Defaults to <code class="inline">:none</code>.</li></ul><h2 id="categorical_hinge/3-examples" class="section-heading">
  <a href="#categorical_hinge/3-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>
<pre><code class="makeup elixir"><span class="gp unselectable">iex&gt; </span><span class="n">y_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="1782432373-1">(</span><span class="p" data-group-id="1782432373-2">[</span><span class="p" data-group-id="1782432373-3">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="1782432373-3">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1782432373-4">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="1782432373-4">]</span><span class="p" data-group-id="1782432373-2">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="1782432373-5">{</span><span class="ss">:s</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p" data-group-id="1782432373-5">}</span><span class="p" data-group-id="1782432373-1">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="1782432373-6">(</span><span class="p" data-group-id="1782432373-7">[</span><span class="p" data-group-id="1782432373-8">[</span><span class="mf">0.05300799</span><span class="p">,</span><span class="w"> </span><span class="mf">0.21617081</span><span class="p">,</span><span class="w"> </span><span class="mf">0.68642382</span><span class="p" data-group-id="1782432373-8">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1782432373-9">[</span><span class="mf">0.3754382</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mf">0.08494169</span><span class="p">,</span><span class="w"> </span><span class="mf">0.13442067</span><span class="p" data-group-id="1782432373-9">]</span><span class="p" data-group-id="1782432373-7">]</span><span class="p" data-group-id="1782432373-6">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">categorical_hinge</span><span class="p" data-group-id="1782432373-10">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p" data-group-id="1782432373-10">)</span><span class="w">
</span><span class="p" data-group-id="1782432373-11">#</span><span class="nc" data-group-id="1782432373-11">Nx.Tensor</span><span class="p" data-group-id="1782432373-11">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="p" data-group-id="1782432373-12">[</span><span class="mi">2</span><span class="p" data-group-id="1782432373-12">]</span><span class="w">
  </span><span class="p" data-group-id="1782432373-13">[</span><span class="mf">1.6334158182144165</span><span class="p">,</span><span class="w"> </span><span class="mf">1.2410175800323486</span><span class="p" data-group-id="1782432373-13">]</span><span class="w">
</span><span class="p" data-group-id="1782432373-11">&gt;</span><span class="w">

</span><span class="gp unselectable">iex&gt; </span><span class="n">y_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="1782432373-14">(</span><span class="p" data-group-id="1782432373-15">[</span><span class="p" data-group-id="1782432373-16">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="1782432373-16">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1782432373-17">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="1782432373-17">]</span><span class="p" data-group-id="1782432373-15">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="1782432373-18">{</span><span class="ss">:s</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p" data-group-id="1782432373-18">}</span><span class="p" data-group-id="1782432373-14">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="1782432373-19">(</span><span class="p" data-group-id="1782432373-20">[</span><span class="p" data-group-id="1782432373-21">[</span><span class="mf">0.05300799</span><span class="p">,</span><span class="w"> </span><span class="mf">0.21617081</span><span class="p">,</span><span class="w"> </span><span class="mf">0.68642382</span><span class="p" data-group-id="1782432373-21">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1782432373-22">[</span><span class="mf">0.3754382</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mf">0.08494169</span><span class="p">,</span><span class="w"> </span><span class="mf">0.13442067</span><span class="p" data-group-id="1782432373-22">]</span><span class="p" data-group-id="1782432373-20">]</span><span class="p" data-group-id="1782432373-19">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">categorical_hinge</span><span class="p" data-group-id="1782432373-23">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p">,</span><span class="w"> </span><span class="ss">reduction</span><span class="p">:</span><span class="w"> </span><span class="ss">:mean</span><span class="p" data-group-id="1782432373-23">)</span><span class="w">
</span><span class="p" data-group-id="1782432373-24">#</span><span class="nc" data-group-id="1782432373-24">Nx.Tensor</span><span class="p" data-group-id="1782432373-24">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="w">
  </span><span class="mf">1.4372167587280273</span><span class="w">
</span><span class="p" data-group-id="1782432373-24">&gt;</span><span class="w">

</span><span class="gp unselectable">iex&gt; </span><span class="n">y_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="1782432373-25">(</span><span class="p" data-group-id="1782432373-26">[</span><span class="p" data-group-id="1782432373-27">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="1782432373-27">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1782432373-28">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="1782432373-28">]</span><span class="p" data-group-id="1782432373-26">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="1782432373-29">{</span><span class="ss">:s</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p" data-group-id="1782432373-29">}</span><span class="p" data-group-id="1782432373-25">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="1782432373-30">(</span><span class="p" data-group-id="1782432373-31">[</span><span class="p" data-group-id="1782432373-32">[</span><span class="mf">0.05300799</span><span class="p">,</span><span class="w"> </span><span class="mf">0.21617081</span><span class="p">,</span><span class="w"> </span><span class="mf">0.68642382</span><span class="p" data-group-id="1782432373-32">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1782432373-33">[</span><span class="mf">0.3754382</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mf">0.08494169</span><span class="p">,</span><span class="w"> </span><span class="mf">0.13442067</span><span class="p" data-group-id="1782432373-33">]</span><span class="p" data-group-id="1782432373-31">]</span><span class="p" data-group-id="1782432373-30">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">categorical_hinge</span><span class="p" data-group-id="1782432373-34">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p">,</span><span class="w"> </span><span class="ss">reduction</span><span class="p">:</span><span class="w"> </span><span class="ss">:sum</span><span class="p" data-group-id="1782432373-34">)</span><span class="w">
</span><span class="p" data-group-id="1782432373-35">#</span><span class="nc" data-group-id="1782432373-35">Nx.Tensor</span><span class="p" data-group-id="1782432373-35">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="w">
  </span><span class="mf">2.8744335174560547</span><span class="w">
</span><span class="p" data-group-id="1782432373-35">&gt;</span></code></pre>
  </section>
</section>
<section class="detail" id="hinge/3">

    <span id="hinge/2"></span>

  <div class="detail-header">
    <a href="#hinge/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">hinge(y_true, y_pred, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.1.0-dev/lib/axon/losses.ex#L0" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Hinge loss function.</p><p>$$\frac{1}{C}\max_i(1 - \hat{y_i} * y_i, 0)$$</p><h2 id="hinge/3-options" class="section-heading">
  <a href="#hinge/3-options" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Options
</h2>
<ul><li><code class="inline">:reduction</code> - reduction mode. One of <code class="inline">:mean</code>, <code class="inline">:sum</code>, or <code class="inline">:none</code>.
Defaults to <code class="inline">:none</code>.</li></ul><h2 id="hinge/3-argument-shapes" class="section-heading">
  <a href="#hinge/3-argument-shapes" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Argument Shapes
</h2>
<ul><li><code class="inline">y_true</code> - $(d_0, d_1, ..., d_n)$</li><li><code class="inline">y_pred</code> - $(d_0, d_1, ..., d_n)$</li></ul><h2 id="hinge/3-examples" class="section-heading">
  <a href="#hinge/3-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>
<pre><code class="makeup elixir"><span class="gp unselectable">iex&gt; </span><span class="n">y_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="3018079234-1">(</span><span class="p" data-group-id="3018079234-2">[</span><span class="p" data-group-id="3018079234-3">[</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">  </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p" data-group-id="3018079234-3">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3018079234-4">[</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">  </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p" data-group-id="3018079234-4">]</span><span class="p" data-group-id="3018079234-2">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3018079234-5">{</span><span class="ss">:s</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p" data-group-id="3018079234-5">}</span><span class="p" data-group-id="3018079234-1">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="3018079234-6">(</span><span class="p" data-group-id="3018079234-7">[</span><span class="p" data-group-id="3018079234-8">[</span><span class="mf">0.45440044</span><span class="p">,</span><span class="w"> </span><span class="mf">0.31470688</span><span class="p">,</span><span class="w"> </span><span class="mf">0.67920924</span><span class="p" data-group-id="3018079234-8">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3018079234-9">[</span><span class="mf">0.24311459</span><span class="p">,</span><span class="w"> </span><span class="mf">0.93466766</span><span class="p">,</span><span class="w"> </span><span class="mf">0.10914676</span><span class="p" data-group-id="3018079234-9">]</span><span class="p" data-group-id="3018079234-7">]</span><span class="p" data-group-id="3018079234-6">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">hinge</span><span class="p" data-group-id="3018079234-10">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p" data-group-id="3018079234-10">)</span><span class="w">
</span><span class="p" data-group-id="3018079234-11">#</span><span class="nc" data-group-id="3018079234-11">Nx.Tensor</span><span class="p" data-group-id="3018079234-11">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="p" data-group-id="3018079234-12">[</span><span class="mi">2</span><span class="p" data-group-id="3018079234-12">]</span><span class="w">
  </span><span class="p" data-group-id="3018079234-13">[</span><span class="mf">0.9700339436531067</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6437881588935852</span><span class="p" data-group-id="3018079234-13">]</span><span class="w">
</span><span class="p" data-group-id="3018079234-11">&gt;</span><span class="w">

</span><span class="gp unselectable">iex&gt; </span><span class="n">y_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="3018079234-14">(</span><span class="p" data-group-id="3018079234-15">[</span><span class="p" data-group-id="3018079234-16">[</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">  </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p" data-group-id="3018079234-16">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3018079234-17">[</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">  </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p" data-group-id="3018079234-17">]</span><span class="p" data-group-id="3018079234-15">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3018079234-18">{</span><span class="ss">:s</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p" data-group-id="3018079234-18">}</span><span class="p" data-group-id="3018079234-14">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="3018079234-19">(</span><span class="p" data-group-id="3018079234-20">[</span><span class="p" data-group-id="3018079234-21">[</span><span class="mf">0.45440044</span><span class="p">,</span><span class="w"> </span><span class="mf">0.31470688</span><span class="p">,</span><span class="w"> </span><span class="mf">0.67920924</span><span class="p" data-group-id="3018079234-21">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3018079234-22">[</span><span class="mf">0.24311459</span><span class="p">,</span><span class="w"> </span><span class="mf">0.93466766</span><span class="p">,</span><span class="w"> </span><span class="mf">0.10914676</span><span class="p" data-group-id="3018079234-22">]</span><span class="p" data-group-id="3018079234-20">]</span><span class="p" data-group-id="3018079234-19">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">hinge</span><span class="p" data-group-id="3018079234-23">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p">,</span><span class="w"> </span><span class="ss">reduction</span><span class="p">:</span><span class="w"> </span><span class="ss">:mean</span><span class="p" data-group-id="3018079234-23">)</span><span class="w">
</span><span class="p" data-group-id="3018079234-24">#</span><span class="nc" data-group-id="3018079234-24">Nx.Tensor</span><span class="p" data-group-id="3018079234-24">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="w">
  </span><span class="mf">0.806911051273346</span><span class="w">
</span><span class="p" data-group-id="3018079234-24">&gt;</span><span class="w">

</span><span class="gp unselectable">iex&gt; </span><span class="n">y_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="3018079234-25">(</span><span class="p" data-group-id="3018079234-26">[</span><span class="p" data-group-id="3018079234-27">[</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">  </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p" data-group-id="3018079234-27">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3018079234-28">[</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">  </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p" data-group-id="3018079234-28">]</span><span class="p" data-group-id="3018079234-26">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3018079234-29">{</span><span class="ss">:s</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p" data-group-id="3018079234-29">}</span><span class="p" data-group-id="3018079234-25">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="3018079234-30">(</span><span class="p" data-group-id="3018079234-31">[</span><span class="p" data-group-id="3018079234-32">[</span><span class="mf">0.45440044</span><span class="p">,</span><span class="w"> </span><span class="mf">0.31470688</span><span class="p">,</span><span class="w"> </span><span class="mf">0.67920924</span><span class="p" data-group-id="3018079234-32">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3018079234-33">[</span><span class="mf">0.24311459</span><span class="p">,</span><span class="w"> </span><span class="mf">0.93466766</span><span class="p">,</span><span class="w"> </span><span class="mf">0.10914676</span><span class="p" data-group-id="3018079234-33">]</span><span class="p" data-group-id="3018079234-31">]</span><span class="p" data-group-id="3018079234-30">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">hinge</span><span class="p" data-group-id="3018079234-34">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p">,</span><span class="w"> </span><span class="ss">reduction</span><span class="p">:</span><span class="w"> </span><span class="ss">:sum</span><span class="p" data-group-id="3018079234-34">)</span><span class="w">
</span><span class="p" data-group-id="3018079234-35">#</span><span class="nc" data-group-id="3018079234-35">Nx.Tensor</span><span class="p" data-group-id="3018079234-35">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="w">
  </span><span class="mf">1.613822102546692</span><span class="w">
</span><span class="p" data-group-id="3018079234-35">&gt;</span></code></pre>
  </section>
</section>
<section class="detail" id="kl_divergence/3">

    <span id="kl_divergence/2"></span>

  <div class="detail-header">
    <a href="#kl_divergence/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">kl_divergence(y_true, y_pred, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.1.0-dev/lib/axon/losses.ex#L0" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Kullback-Leibler divergence loss function.</p><p>$$l_i = \sum_i^C \hat{y_i} \cdot \log(\frac{\hat{y_i}}{y_i})$$</p><h2 id="kl_divergence/3-argument-shapes" class="section-heading">
  <a href="#kl_divergence/3-argument-shapes" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Argument Shapes
</h2>
<ul><li><code class="inline">y_true</code> - $(d_0, d_1, ..., d_n)$</li><li><code class="inline">y_pred</code> - $(d_0, d_1, ..., d_n)$</li></ul><h2 id="kl_divergence/3-options" class="section-heading">
  <a href="#kl_divergence/3-options" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Options
</h2>
<ul><li><code class="inline">:reduction</code> - reduction mode. One of <code class="inline">:mean</code>, <code class="inline">:sum</code>, or <code class="inline">:none</code>.
Defaults to <code class="inline">:none</code>.</li></ul><h2 id="kl_divergence/3-examples" class="section-heading">
  <a href="#kl_divergence/3-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>
<pre><code class="makeup elixir"><span class="gp unselectable">iex&gt; </span><span class="n">y_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="8104412961-1">(</span><span class="p" data-group-id="8104412961-2">[</span><span class="p" data-group-id="8104412961-3">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="8104412961-3">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8104412961-4">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="8104412961-4">]</span><span class="p" data-group-id="8104412961-2">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="8104412961-5">{</span><span class="ss">:u</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p" data-group-id="8104412961-5">}</span><span class="p" data-group-id="8104412961-1">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="8104412961-6">(</span><span class="p" data-group-id="8104412961-7">[</span><span class="p" data-group-id="8104412961-8">[</span><span class="mf">0.6</span><span class="p">,</span><span class="w"> </span><span class="mf">0.4</span><span class="p" data-group-id="8104412961-8">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8104412961-9">[</span><span class="mf">0.4</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6</span><span class="p" data-group-id="8104412961-9">]</span><span class="p" data-group-id="8104412961-7">]</span><span class="p" data-group-id="8104412961-6">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">kl_divergence</span><span class="p" data-group-id="8104412961-10">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p" data-group-id="8104412961-10">)</span><span class="w">
</span><span class="p" data-group-id="8104412961-11">#</span><span class="nc" data-group-id="8104412961-11">Nx.Tensor</span><span class="p" data-group-id="8104412961-11">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="p" data-group-id="8104412961-12">[</span><span class="mi">2</span><span class="p" data-group-id="8104412961-12">]</span><span class="w">
  </span><span class="p" data-group-id="8104412961-13">[</span><span class="mf">0.916289210319519</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">3.080907390540233e-6</span><span class="p" data-group-id="8104412961-13">]</span><span class="w">
</span><span class="p" data-group-id="8104412961-11">&gt;</span><span class="w">

</span><span class="gp unselectable">iex&gt; </span><span class="n">y_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="8104412961-14">(</span><span class="p" data-group-id="8104412961-15">[</span><span class="p" data-group-id="8104412961-16">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="8104412961-16">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8104412961-17">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="8104412961-17">]</span><span class="p" data-group-id="8104412961-15">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="8104412961-18">{</span><span class="ss">:u</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p" data-group-id="8104412961-18">}</span><span class="p" data-group-id="8104412961-14">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="8104412961-19">(</span><span class="p" data-group-id="8104412961-20">[</span><span class="p" data-group-id="8104412961-21">[</span><span class="mf">0.6</span><span class="p">,</span><span class="w"> </span><span class="mf">0.4</span><span class="p" data-group-id="8104412961-21">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8104412961-22">[</span><span class="mf">0.4</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6</span><span class="p" data-group-id="8104412961-22">]</span><span class="p" data-group-id="8104412961-20">]</span><span class="p" data-group-id="8104412961-19">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">kl_divergence</span><span class="p" data-group-id="8104412961-23">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p">,</span><span class="w"> </span><span class="ss">reduction</span><span class="p">:</span><span class="w"> </span><span class="ss">:mean</span><span class="p" data-group-id="8104412961-23">)</span><span class="w">
</span><span class="p" data-group-id="8104412961-24">#</span><span class="nc" data-group-id="8104412961-24">Nx.Tensor</span><span class="p" data-group-id="8104412961-24">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="w">
  </span><span class="mf">0.45814305543899536</span><span class="w">
</span><span class="p" data-group-id="8104412961-24">&gt;</span><span class="w">

</span><span class="gp unselectable">iex&gt; </span><span class="n">y_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="8104412961-25">(</span><span class="p" data-group-id="8104412961-26">[</span><span class="p" data-group-id="8104412961-27">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="8104412961-27">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8104412961-28">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="8104412961-28">]</span><span class="p" data-group-id="8104412961-26">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="8104412961-29">{</span><span class="ss">:u</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p" data-group-id="8104412961-29">}</span><span class="p" data-group-id="8104412961-25">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="8104412961-30">(</span><span class="p" data-group-id="8104412961-31">[</span><span class="p" data-group-id="8104412961-32">[</span><span class="mf">0.6</span><span class="p">,</span><span class="w"> </span><span class="mf">0.4</span><span class="p" data-group-id="8104412961-32">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8104412961-33">[</span><span class="mf">0.4</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6</span><span class="p" data-group-id="8104412961-33">]</span><span class="p" data-group-id="8104412961-31">]</span><span class="p" data-group-id="8104412961-30">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">kl_divergence</span><span class="p" data-group-id="8104412961-34">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p">,</span><span class="w"> </span><span class="ss">reduction</span><span class="p">:</span><span class="w"> </span><span class="ss">:sum</span><span class="p" data-group-id="8104412961-34">)</span><span class="w">
</span><span class="p" data-group-id="8104412961-35">#</span><span class="nc" data-group-id="8104412961-35">Nx.Tensor</span><span class="p" data-group-id="8104412961-35">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="w">
  </span><span class="mf">0.9162861108779907</span><span class="w">
</span><span class="p" data-group-id="8104412961-35">&gt;</span></code></pre>
  </section>
</section>
<section class="detail" id="log_cosh/3">

    <span id="log_cosh/2"></span>

  <div class="detail-header">
    <a href="#log_cosh/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">log_cosh(y_true, y_pred, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.1.0-dev/lib/axon/losses.ex#L0" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Logarithmic-Hyperbolic Cosine loss function.</p><p>$$l_i = \frac{1}{C} \sum_i^C (\hat{y_i} - y_i) + \log(1 + e^{-2(\hat{y_i} - y_i)}) - \log(2)$$</p><h2 id="log_cosh/3-argument-shapes" class="section-heading">
  <a href="#log_cosh/3-argument-shapes" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Argument Shapes
</h2>
<ul><li><code class="inline">y_true</code> - $(d_0, d_1, ..., d_n)$</li><li><code class="inline">y_pred</code> - $(d_0, d_1, ..., d_n)$</li></ul><h2 id="log_cosh/3-options" class="section-heading">
  <a href="#log_cosh/3-options" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Options
</h2>
<ul><li><code class="inline">:reduction</code> - reduction mode. One of <code class="inline">:mean</code>, <code class="inline">:sum</code>, or <code class="inline">:none</code>.
Defaults to <code class="inline">:none</code>.</li></ul><h2 id="log_cosh/3-examples" class="section-heading">
  <a href="#log_cosh/3-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>
<pre><code class="makeup elixir"><span class="gp unselectable">iex&gt; </span><span class="n">y_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="5495226786-1">(</span><span class="p" data-group-id="5495226786-2">[</span><span class="p" data-group-id="5495226786-3">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p" data-group-id="5495226786-3">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5495226786-4">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p" data-group-id="5495226786-4">]</span><span class="p" data-group-id="5495226786-2">]</span><span class="p" data-group-id="5495226786-1">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="5495226786-5">(</span><span class="p" data-group-id="5495226786-6">[</span><span class="p" data-group-id="5495226786-7">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p" data-group-id="5495226786-7">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5495226786-8">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p" data-group-id="5495226786-8">]</span><span class="p" data-group-id="5495226786-6">]</span><span class="p" data-group-id="5495226786-5">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">log_cosh</span><span class="p" data-group-id="5495226786-9">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p" data-group-id="5495226786-9">)</span><span class="w">
</span><span class="p" data-group-id="5495226786-10">#</span><span class="nc" data-group-id="5495226786-10">Nx.Tensor</span><span class="p" data-group-id="5495226786-10">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="p" data-group-id="5495226786-11">[</span><span class="mi">2</span><span class="p" data-group-id="5495226786-11">]</span><span class="w">
  </span><span class="p" data-group-id="5495226786-12">[</span><span class="mf">0.2168903946876526</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p" data-group-id="5495226786-12">]</span><span class="w">
</span><span class="p" data-group-id="5495226786-10">&gt;</span><span class="w">

</span><span class="gp unselectable">iex&gt; </span><span class="n">y_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="5495226786-13">(</span><span class="p" data-group-id="5495226786-14">[</span><span class="p" data-group-id="5495226786-15">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p" data-group-id="5495226786-15">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5495226786-16">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p" data-group-id="5495226786-16">]</span><span class="p" data-group-id="5495226786-14">]</span><span class="p" data-group-id="5495226786-13">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="5495226786-17">(</span><span class="p" data-group-id="5495226786-18">[</span><span class="p" data-group-id="5495226786-19">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p" data-group-id="5495226786-19">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5495226786-20">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p" data-group-id="5495226786-20">]</span><span class="p" data-group-id="5495226786-18">]</span><span class="p" data-group-id="5495226786-17">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">log_cosh</span><span class="p" data-group-id="5495226786-21">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p">,</span><span class="w"> </span><span class="ss">reduction</span><span class="p">:</span><span class="w"> </span><span class="ss">:mean</span><span class="p" data-group-id="5495226786-21">)</span><span class="w">
</span><span class="p" data-group-id="5495226786-22">#</span><span class="nc" data-group-id="5495226786-22">Nx.Tensor</span><span class="p" data-group-id="5495226786-22">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="w">
  </span><span class="mf">0.1084451973438263</span><span class="w">
</span><span class="p" data-group-id="5495226786-22">&gt;</span><span class="w">

</span><span class="gp unselectable">iex&gt; </span><span class="n">y_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="5495226786-23">(</span><span class="p" data-group-id="5495226786-24">[</span><span class="p" data-group-id="5495226786-25">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p" data-group-id="5495226786-25">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5495226786-26">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p" data-group-id="5495226786-26">]</span><span class="p" data-group-id="5495226786-24">]</span><span class="p" data-group-id="5495226786-23">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="5495226786-27">(</span><span class="p" data-group-id="5495226786-28">[</span><span class="p" data-group-id="5495226786-29">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p" data-group-id="5495226786-29">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5495226786-30">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p" data-group-id="5495226786-30">]</span><span class="p" data-group-id="5495226786-28">]</span><span class="p" data-group-id="5495226786-27">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">log_cosh</span><span class="p" data-group-id="5495226786-31">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p">,</span><span class="w"> </span><span class="ss">reduction</span><span class="p">:</span><span class="w"> </span><span class="ss">:sum</span><span class="p" data-group-id="5495226786-31">)</span><span class="w">
</span><span class="p" data-group-id="5495226786-32">#</span><span class="nc" data-group-id="5495226786-32">Nx.Tensor</span><span class="p" data-group-id="5495226786-32">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="w">
  </span><span class="mf">0.2168903946876526</span><span class="w">
</span><span class="p" data-group-id="5495226786-32">&gt;</span></code></pre>
  </section>
</section>
<section class="detail" id="margin_ranking/3">

    <span id="margin_ranking/2"></span>

  <div class="detail-header">
    <a href="#margin_ranking/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">margin_ranking(y_true, arg2, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.1.0-dev/lib/axon/losses.ex#L0" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Margin ranking loss function.</p><p>$$l_i = \max(0, -\hat{y_i} * (y^(1)_i - y^(2)_i) + \alpha)$$</p><h2 id="margin_ranking/3-options" class="section-heading">
  <a href="#margin_ranking/3-options" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Options
</h2>
<ul><li><code class="inline">:reduction</code> - reduction mode. One of <code class="inline">:mean</code>, <code class="inline">:sum</code>, or <code class="inline">:none</code>.
Defaults to <code class="inline">:none</code>.</li></ul><h2 id="margin_ranking/3-examples" class="section-heading">
  <a href="#margin_ranking/3-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>
<pre><code class="makeup elixir"><span class="gp unselectable">iex&gt; </span><span class="n">y_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="3325478403-1">(</span><span class="p" data-group-id="3325478403-2">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p" data-group-id="3325478403-2">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3325478403-3">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="3325478403-3">}</span><span class="p" data-group-id="3325478403-1">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="3325478403-4">(</span><span class="p" data-group-id="3325478403-5">[</span><span class="mf">0.6934</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.7239</span><span class="p">,</span><span class="w">  </span><span class="mf">1.1954</span><span class="p" data-group-id="3325478403-5">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3325478403-6">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="3325478403-6">}</span><span class="p" data-group-id="3325478403-4">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="3325478403-7">(</span><span class="p" data-group-id="3325478403-8">[</span><span class="o">-</span><span class="mf">0.4691</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2670</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">1.7452</span><span class="p" data-group-id="3325478403-8">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3325478403-9">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="3325478403-9">}</span><span class="p" data-group-id="3325478403-7">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">margin_ranking</span><span class="p" data-group-id="3325478403-10">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3325478403-11">{</span><span class="n">y_pred1</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred2</span><span class="p" data-group-id="3325478403-11">}</span><span class="p" data-group-id="3325478403-10">)</span><span class="w">
</span><span class="p" data-group-id="3325478403-12">#</span><span class="nc" data-group-id="3325478403-12">Nx.Tensor</span><span class="p" data-group-id="3325478403-12">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="p" data-group-id="3325478403-13">[</span><span class="mi">3</span><span class="p" data-group-id="3325478403-13">]</span><span class="w">
  </span><span class="p" data-group-id="3325478403-14">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9909000396728516</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p" data-group-id="3325478403-14">]</span><span class="w">
</span><span class="p" data-group-id="3325478403-12">&gt;</span><span class="w">

</span><span class="gp unselectable">iex&gt; </span><span class="n">y_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="3325478403-15">(</span><span class="p" data-group-id="3325478403-16">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p" data-group-id="3325478403-16">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3325478403-17">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="3325478403-17">}</span><span class="p" data-group-id="3325478403-15">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="3325478403-18">(</span><span class="p" data-group-id="3325478403-19">[</span><span class="mf">0.6934</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.7239</span><span class="p">,</span><span class="w">  </span><span class="mf">1.1954</span><span class="p" data-group-id="3325478403-19">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3325478403-20">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="3325478403-20">}</span><span class="p" data-group-id="3325478403-18">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="3325478403-21">(</span><span class="p" data-group-id="3325478403-22">[</span><span class="o">-</span><span class="mf">0.4691</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2670</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">1.7452</span><span class="p" data-group-id="3325478403-22">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3325478403-23">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="3325478403-23">}</span><span class="p" data-group-id="3325478403-21">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">margin_ranking</span><span class="p" data-group-id="3325478403-24">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3325478403-25">{</span><span class="n">y_pred1</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred2</span><span class="p" data-group-id="3325478403-25">}</span><span class="p">,</span><span class="w"> </span><span class="ss">reduction</span><span class="p">:</span><span class="w"> </span><span class="ss">:mean</span><span class="p" data-group-id="3325478403-24">)</span><span class="w">
</span><span class="p" data-group-id="3325478403-26">#</span><span class="nc" data-group-id="3325478403-26">Nx.Tensor</span><span class="p" data-group-id="3325478403-26">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="w">
  </span><span class="mf">0.3303000032901764</span><span class="w">
</span><span class="p" data-group-id="3325478403-26">&gt;</span><span class="w">

</span><span class="gp unselectable">iex&gt; </span><span class="n">y_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="3325478403-27">(</span><span class="p" data-group-id="3325478403-28">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p" data-group-id="3325478403-28">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3325478403-29">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="3325478403-29">}</span><span class="p" data-group-id="3325478403-27">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="3325478403-30">(</span><span class="p" data-group-id="3325478403-31">[</span><span class="mf">0.6934</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.7239</span><span class="p">,</span><span class="w">  </span><span class="mf">1.1954</span><span class="p" data-group-id="3325478403-31">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3325478403-32">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="3325478403-32">}</span><span class="p" data-group-id="3325478403-30">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="3325478403-33">(</span><span class="p" data-group-id="3325478403-34">[</span><span class="o">-</span><span class="mf">0.4691</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2670</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">1.7452</span><span class="p" data-group-id="3325478403-34">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3325478403-35">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="3325478403-35">}</span><span class="p" data-group-id="3325478403-33">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">margin_ranking</span><span class="p" data-group-id="3325478403-36">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3325478403-37">{</span><span class="n">y_pred1</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred2</span><span class="p" data-group-id="3325478403-37">}</span><span class="p">,</span><span class="w"> </span><span class="ss">reduction</span><span class="p">:</span><span class="w"> </span><span class="ss">:sum</span><span class="p" data-group-id="3325478403-36">)</span><span class="w">
</span><span class="p" data-group-id="3325478403-38">#</span><span class="nc" data-group-id="3325478403-38">Nx.Tensor</span><span class="p" data-group-id="3325478403-38">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="w">
  </span><span class="mf">0.9909000396728516</span><span class="w">
</span><span class="p" data-group-id="3325478403-38">&gt;</span></code></pre>
  </section>
</section>
<section class="detail" id="mean_absolute_error/3">

    <span id="mean_absolute_error/2"></span>

  <div class="detail-header">
    <a href="#mean_absolute_error/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">mean_absolute_error(y_true, y_pred, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.1.0-dev/lib/axon/losses.ex#L0" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Mean-absolute error loss function.</p><p>$$l_i = \sum_i |\hat{y_i} - y_i|$$</p><h2 id="mean_absolute_error/3-argument-shapes" class="section-heading">
  <a href="#mean_absolute_error/3-argument-shapes" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Argument Shapes
</h2>
<ul><li><code class="inline">y_true</code> - $(d_0, d_1, ..., d_n)$</li><li><code class="inline">y_pred</code> - $(d_0, d_1, ..., d_n)$</li></ul><h2 id="mean_absolute_error/3-options" class="section-heading">
  <a href="#mean_absolute_error/3-options" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Options
</h2>
<ul><li><code class="inline">:reduction</code> - reduction mode. One of <code class="inline">:mean</code>, <code class="inline">:sum</code>, or <code class="inline">:none</code>.
Defaults to <code class="inline">:none</code>.</li></ul><h2 id="mean_absolute_error/3-examples" class="section-heading">
  <a href="#mean_absolute_error/3-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>
<pre><code class="makeup elixir"><span class="gp unselectable">iex&gt; </span><span class="n">y_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="4494046804-1">(</span><span class="p" data-group-id="4494046804-2">[</span><span class="p" data-group-id="4494046804-3">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p" data-group-id="4494046804-3">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4494046804-4">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p" data-group-id="4494046804-4">]</span><span class="p" data-group-id="4494046804-2">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="4494046804-5">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="4494046804-5">}</span><span class="p" data-group-id="4494046804-1">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="4494046804-6">(</span><span class="p" data-group-id="4494046804-7">[</span><span class="p" data-group-id="4494046804-8">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p" data-group-id="4494046804-8">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4494046804-9">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p" data-group-id="4494046804-9">]</span><span class="p" data-group-id="4494046804-7">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="4494046804-10">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="4494046804-10">}</span><span class="p" data-group-id="4494046804-6">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">mean_absolute_error</span><span class="p" data-group-id="4494046804-11">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p" data-group-id="4494046804-11">)</span><span class="w">
</span><span class="p" data-group-id="4494046804-12">#</span><span class="nc" data-group-id="4494046804-12">Nx.Tensor</span><span class="p" data-group-id="4494046804-12">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="p" data-group-id="4494046804-13">[</span><span class="mi">2</span><span class="p" data-group-id="4494046804-13">]</span><span class="w">
  </span><span class="p" data-group-id="4494046804-14">[</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p" data-group-id="4494046804-14">]</span><span class="w">
</span><span class="p" data-group-id="4494046804-12">&gt;</span><span class="w">

</span><span class="gp unselectable">iex&gt; </span><span class="n">y_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="4494046804-15">(</span><span class="p" data-group-id="4494046804-16">[</span><span class="p" data-group-id="4494046804-17">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p" data-group-id="4494046804-17">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4494046804-18">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p" data-group-id="4494046804-18">]</span><span class="p" data-group-id="4494046804-16">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="4494046804-19">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="4494046804-19">}</span><span class="p" data-group-id="4494046804-15">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="4494046804-20">(</span><span class="p" data-group-id="4494046804-21">[</span><span class="p" data-group-id="4494046804-22">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p" data-group-id="4494046804-22">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4494046804-23">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p" data-group-id="4494046804-23">]</span><span class="p" data-group-id="4494046804-21">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="4494046804-24">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="4494046804-24">}</span><span class="p" data-group-id="4494046804-20">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">mean_absolute_error</span><span class="p" data-group-id="4494046804-25">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p">,</span><span class="w"> </span><span class="ss">reduction</span><span class="p">:</span><span class="w"> </span><span class="ss">:mean</span><span class="p" data-group-id="4494046804-25">)</span><span class="w">
</span><span class="p" data-group-id="4494046804-26">#</span><span class="nc" data-group-id="4494046804-26">Nx.Tensor</span><span class="p" data-group-id="4494046804-26">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="w">
  </span><span class="mf">0.5</span><span class="w">
</span><span class="p" data-group-id="4494046804-26">&gt;</span><span class="w">

</span><span class="gp unselectable">iex&gt; </span><span class="n">y_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="4494046804-27">(</span><span class="p" data-group-id="4494046804-28">[</span><span class="p" data-group-id="4494046804-29">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p" data-group-id="4494046804-29">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4494046804-30">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p" data-group-id="4494046804-30">]</span><span class="p" data-group-id="4494046804-28">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="4494046804-31">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="4494046804-31">}</span><span class="p" data-group-id="4494046804-27">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="4494046804-32">(</span><span class="p" data-group-id="4494046804-33">[</span><span class="p" data-group-id="4494046804-34">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p" data-group-id="4494046804-34">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4494046804-35">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p" data-group-id="4494046804-35">]</span><span class="p" data-group-id="4494046804-33">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="4494046804-36">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="4494046804-36">}</span><span class="p" data-group-id="4494046804-32">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">mean_absolute_error</span><span class="p" data-group-id="4494046804-37">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p">,</span><span class="w"> </span><span class="ss">reduction</span><span class="p">:</span><span class="w"> </span><span class="ss">:sum</span><span class="p" data-group-id="4494046804-37">)</span><span class="w">
</span><span class="p" data-group-id="4494046804-38">#</span><span class="nc" data-group-id="4494046804-38">Nx.Tensor</span><span class="p" data-group-id="4494046804-38">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="w">
  </span><span class="mf">1.0</span><span class="w">
</span><span class="p" data-group-id="4494046804-38">&gt;</span></code></pre>
  </section>
</section>
<section class="detail" id="mean_squared_error/3">

    <span id="mean_squared_error/2"></span>

  <div class="detail-header">
    <a href="#mean_squared_error/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">mean_squared_error(y_true, y_pred, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.1.0-dev/lib/axon/losses.ex#L0" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Mean-squared error loss function.</p><p>$$l_i = \sum_i (\hat{y_i} - y_i)^2$$</p><h2 id="mean_squared_error/3-argument-shapes" class="section-heading">
  <a href="#mean_squared_error/3-argument-shapes" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Argument Shapes
</h2>
<ul><li><code class="inline">y_true</code> - $(d_0, d_1, ..., d_n)$</li><li><code class="inline">y_pred</code> - $(d_0, d_1, ..., d_n)$</li></ul><h2 id="mean_squared_error/3-options" class="section-heading">
  <a href="#mean_squared_error/3-options" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Options
</h2>
<ul><li><code class="inline">:reduction</code> - reduction mode. One of <code class="inline">:mean</code>, <code class="inline">:sum</code>, or <code class="inline">:none</code>.
Defaults to <code class="inline">:none</code>.</li></ul><h2 id="mean_squared_error/3-examples" class="section-heading">
  <a href="#mean_squared_error/3-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>
<pre><code class="makeup elixir"><span class="gp unselectable">iex&gt; </span><span class="n">y_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="5684162742-1">(</span><span class="p" data-group-id="5684162742-2">[</span><span class="p" data-group-id="5684162742-3">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p" data-group-id="5684162742-3">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5684162742-4">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p" data-group-id="5684162742-4">]</span><span class="p" data-group-id="5684162742-2">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="5684162742-5">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="5684162742-5">}</span><span class="p" data-group-id="5684162742-1">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="5684162742-6">(</span><span class="p" data-group-id="5684162742-7">[</span><span class="p" data-group-id="5684162742-8">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p" data-group-id="5684162742-8">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5684162742-9">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p" data-group-id="5684162742-9">]</span><span class="p" data-group-id="5684162742-7">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="5684162742-10">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="5684162742-10">}</span><span class="p" data-group-id="5684162742-6">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p" data-group-id="5684162742-11">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p" data-group-id="5684162742-11">)</span><span class="w">
</span><span class="p" data-group-id="5684162742-12">#</span><span class="nc" data-group-id="5684162742-12">Nx.Tensor</span><span class="p" data-group-id="5684162742-12">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="p" data-group-id="5684162742-13">[</span><span class="mi">2</span><span class="p" data-group-id="5684162742-13">]</span><span class="w">
  </span><span class="p" data-group-id="5684162742-14">[</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p" data-group-id="5684162742-14">]</span><span class="w">
</span><span class="p" data-group-id="5684162742-12">&gt;</span><span class="w">

</span><span class="gp unselectable">iex&gt; </span><span class="n">y_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="5684162742-15">(</span><span class="p" data-group-id="5684162742-16">[</span><span class="p" data-group-id="5684162742-17">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p" data-group-id="5684162742-17">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5684162742-18">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p" data-group-id="5684162742-18">]</span><span class="p" data-group-id="5684162742-16">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="5684162742-19">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="5684162742-19">}</span><span class="p" data-group-id="5684162742-15">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="5684162742-20">(</span><span class="p" data-group-id="5684162742-21">[</span><span class="p" data-group-id="5684162742-22">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p" data-group-id="5684162742-22">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5684162742-23">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p" data-group-id="5684162742-23">]</span><span class="p" data-group-id="5684162742-21">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="5684162742-24">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="5684162742-24">}</span><span class="p" data-group-id="5684162742-20">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p" data-group-id="5684162742-25">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p">,</span><span class="w"> </span><span class="ss">reduction</span><span class="p">:</span><span class="w"> </span><span class="ss">:mean</span><span class="p" data-group-id="5684162742-25">)</span><span class="w">
</span><span class="p" data-group-id="5684162742-26">#</span><span class="nc" data-group-id="5684162742-26">Nx.Tensor</span><span class="p" data-group-id="5684162742-26">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="w">
  </span><span class="mf">0.5</span><span class="w">
</span><span class="p" data-group-id="5684162742-26">&gt;</span><span class="w">

</span><span class="gp unselectable">iex&gt; </span><span class="n">y_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="5684162742-27">(</span><span class="p" data-group-id="5684162742-28">[</span><span class="p" data-group-id="5684162742-29">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p" data-group-id="5684162742-29">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5684162742-30">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p" data-group-id="5684162742-30">]</span><span class="p" data-group-id="5684162742-28">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="5684162742-31">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="5684162742-31">}</span><span class="p" data-group-id="5684162742-27">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="5684162742-32">(</span><span class="p" data-group-id="5684162742-33">[</span><span class="p" data-group-id="5684162742-34">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p" data-group-id="5684162742-34">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5684162742-35">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p" data-group-id="5684162742-35">]</span><span class="p" data-group-id="5684162742-33">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="5684162742-36">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="5684162742-36">}</span><span class="p" data-group-id="5684162742-32">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p" data-group-id="5684162742-37">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p">,</span><span class="w"> </span><span class="ss">reduction</span><span class="p">:</span><span class="w"> </span><span class="ss">:sum</span><span class="p" data-group-id="5684162742-37">)</span><span class="w">
</span><span class="p" data-group-id="5684162742-38">#</span><span class="nc" data-group-id="5684162742-38">Nx.Tensor</span><span class="p" data-group-id="5684162742-38">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="w">
  </span><span class="mf">1.0</span><span class="w">
</span><span class="p" data-group-id="5684162742-38">&gt;</span></code></pre>
  </section>
</section>
<section class="detail" id="poisson/3">

    <span id="poisson/2"></span>

  <div class="detail-header">
    <a href="#poisson/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">poisson(y_true, y_pred, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.1.0-dev/lib/axon/losses.ex#L0" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Poisson loss function.</p><p>$$l_i = \frac{1}{C} \sum_i^C y_i - (\hat{y_i} \cdot \log(y_i))$$</p><h2 id="poisson/3-argument-shapes" class="section-heading">
  <a href="#poisson/3-argument-shapes" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Argument Shapes
</h2>
<ul><li><code class="inline">y_true</code> - $(d_0, d_1, ..., d_n)$</li><li><code class="inline">y_pred</code> - $(d_0, d_1, ..., d_n)$</li></ul><h2 id="poisson/3-options" class="section-heading">
  <a href="#poisson/3-options" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Options
</h2>
<ul><li><code class="inline">:reduction</code> - reduction mode. One of <code class="inline">:mean</code>, <code class="inline">:sum</code>, or <code class="inline">:none</code>.
Defaults to <code class="inline">:none</code>.</li></ul><h2 id="poisson/3-examples" class="section-heading">
  <a href="#poisson/3-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>
<pre><code class="makeup elixir"><span class="gp unselectable">iex&gt; </span><span class="n">y_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="4164587847-1">(</span><span class="p" data-group-id="4164587847-2">[</span><span class="p" data-group-id="4164587847-3">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p" data-group-id="4164587847-3">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4164587847-4">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p" data-group-id="4164587847-4">]</span><span class="p" data-group-id="4164587847-2">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="4164587847-5">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="4164587847-5">}</span><span class="p" data-group-id="4164587847-1">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="4164587847-6">(</span><span class="p" data-group-id="4164587847-7">[</span><span class="p" data-group-id="4164587847-8">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p" data-group-id="4164587847-8">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4164587847-9">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p" data-group-id="4164587847-9">]</span><span class="p" data-group-id="4164587847-7">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="4164587847-10">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="4164587847-10">}</span><span class="p" data-group-id="4164587847-6">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">poisson</span><span class="p" data-group-id="4164587847-11">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p" data-group-id="4164587847-11">)</span><span class="w">
</span><span class="p" data-group-id="4164587847-12">#</span><span class="nc" data-group-id="4164587847-12">Nx.Tensor</span><span class="p" data-group-id="4164587847-12">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="p" data-group-id="4164587847-13">[</span><span class="mi">2</span><span class="p" data-group-id="4164587847-13">]</span><span class="w">
  </span><span class="p" data-group-id="4164587847-14">[</span><span class="mf">0.9999999403953552</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p" data-group-id="4164587847-14">]</span><span class="w">
</span><span class="p" data-group-id="4164587847-12">&gt;</span><span class="w">

</span><span class="gp unselectable">iex&gt; </span><span class="n">y_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="4164587847-15">(</span><span class="p" data-group-id="4164587847-16">[</span><span class="p" data-group-id="4164587847-17">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p" data-group-id="4164587847-17">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4164587847-18">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p" data-group-id="4164587847-18">]</span><span class="p" data-group-id="4164587847-16">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="4164587847-19">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="4164587847-19">}</span><span class="p" data-group-id="4164587847-15">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="4164587847-20">(</span><span class="p" data-group-id="4164587847-21">[</span><span class="p" data-group-id="4164587847-22">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p" data-group-id="4164587847-22">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4164587847-23">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p" data-group-id="4164587847-23">]</span><span class="p" data-group-id="4164587847-21">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="4164587847-24">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="4164587847-24">}</span><span class="p" data-group-id="4164587847-20">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">poisson</span><span class="p" data-group-id="4164587847-25">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p">,</span><span class="w"> </span><span class="ss">reduction</span><span class="p">:</span><span class="w"> </span><span class="ss">:mean</span><span class="p" data-group-id="4164587847-25">)</span><span class="w">
</span><span class="p" data-group-id="4164587847-26">#</span><span class="nc" data-group-id="4164587847-26">Nx.Tensor</span><span class="p" data-group-id="4164587847-26">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="w">
  </span><span class="mf">0.4999999701976776</span><span class="w">
</span><span class="p" data-group-id="4164587847-26">&gt;</span><span class="w">

</span><span class="gp unselectable">iex&gt; </span><span class="n">y_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="4164587847-27">(</span><span class="p" data-group-id="4164587847-28">[</span><span class="p" data-group-id="4164587847-29">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p" data-group-id="4164587847-29">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4164587847-30">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p" data-group-id="4164587847-30">]</span><span class="p" data-group-id="4164587847-28">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="4164587847-31">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="4164587847-31">}</span><span class="p" data-group-id="4164587847-27">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="4164587847-32">(</span><span class="p" data-group-id="4164587847-33">[</span><span class="p" data-group-id="4164587847-34">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p" data-group-id="4164587847-34">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4164587847-35">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p" data-group-id="4164587847-35">]</span><span class="p" data-group-id="4164587847-33">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="4164587847-36">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="4164587847-36">}</span><span class="p" data-group-id="4164587847-32">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">poisson</span><span class="p" data-group-id="4164587847-37">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p">,</span><span class="w"> </span><span class="ss">reduction</span><span class="p">:</span><span class="w"> </span><span class="ss">:sum</span><span class="p" data-group-id="4164587847-37">)</span><span class="w">
</span><span class="p" data-group-id="4164587847-38">#</span><span class="nc" data-group-id="4164587847-38">Nx.Tensor</span><span class="p" data-group-id="4164587847-38">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="w">
  </span><span class="mf">0.9999999403953552</span><span class="w">
</span><span class="p" data-group-id="4164587847-38">&gt;</span></code></pre>
  </section>
</section>
<section class="detail" id="soft_margin/3">

    <span id="soft_margin/2"></span>

  <div class="detail-header">
    <a href="#soft_margin/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">soft_margin(y_true, y_pred, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.1.0-dev/lib/axon/losses.ex#L0" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Soft margin loss function.</p><p>$$l_i = \sum_i \frac{\log(1 + e^{-\hat{y_i} * y_i})}{N}$$</p><h2 id="soft_margin/3-options" class="section-heading">
  <a href="#soft_margin/3-options" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Options
</h2>
<ul><li><code class="inline">:reduction</code> - reduction mode. One of <code class="inline">:mean</code>, <code class="inline">:sum</code>, or <code class="inline">:none</code>.
Defaults to <code class="inline">:none</code>.</li></ul><h2 id="soft_margin/3-examples" class="section-heading">
  <a href="#soft_margin/3-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>
<pre><code class="makeup elixir"><span class="gp unselectable">iex&gt; </span><span class="n">y_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="0462066344-1">(</span><span class="p" data-group-id="0462066344-2">[</span><span class="p" data-group-id="0462066344-3">[</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w">  </span><span class="mf">1.0</span><span class="p" data-group-id="0462066344-3">]</span><span class="p" data-group-id="0462066344-2">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="0462066344-4">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="0462066344-4">}</span><span class="p" data-group-id="0462066344-1">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="0462066344-5">(</span><span class="p" data-group-id="0462066344-6">[</span><span class="p" data-group-id="0462066344-7">[</span><span class="mf">0.2953</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.1709</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9486</span><span class="p" data-group-id="0462066344-7">]</span><span class="p" data-group-id="0462066344-6">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="0462066344-8">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="0462066344-8">}</span><span class="p" data-group-id="0462066344-5">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">soft_margin</span><span class="p" data-group-id="0462066344-9">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p" data-group-id="0462066344-9">)</span><span class="w">
</span><span class="p" data-group-id="0462066344-10">#</span><span class="nc" data-group-id="0462066344-10">Nx.Tensor</span><span class="p" data-group-id="0462066344-10">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="p" data-group-id="0462066344-11">[</span><span class="mi">3</span><span class="p" data-group-id="0462066344-11">]</span><span class="w">
  </span><span class="p" data-group-id="0462066344-12">[</span><span class="mf">0.851658046245575</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7822436094284058</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3273470401763916</span><span class="p" data-group-id="0462066344-12">]</span><span class="w">
</span><span class="p" data-group-id="0462066344-10">&gt;</span><span class="w">

</span><span class="gp unselectable">iex&gt; </span><span class="n">y_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="0462066344-13">(</span><span class="p" data-group-id="0462066344-14">[</span><span class="p" data-group-id="0462066344-15">[</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w">  </span><span class="mf">1.0</span><span class="p" data-group-id="0462066344-15">]</span><span class="p" data-group-id="0462066344-14">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="0462066344-16">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="0462066344-16">}</span><span class="p" data-group-id="0462066344-13">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="0462066344-17">(</span><span class="p" data-group-id="0462066344-18">[</span><span class="p" data-group-id="0462066344-19">[</span><span class="mf">0.2953</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.1709</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9486</span><span class="p" data-group-id="0462066344-19">]</span><span class="p" data-group-id="0462066344-18">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="0462066344-20">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="0462066344-20">}</span><span class="p" data-group-id="0462066344-17">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">soft_margin</span><span class="p" data-group-id="0462066344-21">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p">,</span><span class="w"> </span><span class="ss">reduction</span><span class="p">:</span><span class="w"> </span><span class="ss">:mean</span><span class="p" data-group-id="0462066344-21">)</span><span class="w">
</span><span class="p" data-group-id="0462066344-22">#</span><span class="nc" data-group-id="0462066344-22">Nx.Tensor</span><span class="p" data-group-id="0462066344-22">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="w">
  </span><span class="mf">0.6537495255470276</span><span class="w">
</span><span class="p" data-group-id="0462066344-22">&gt;</span><span class="w">

</span><span class="gp unselectable">iex&gt; </span><span class="n">y_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="0462066344-23">(</span><span class="p" data-group-id="0462066344-24">[</span><span class="p" data-group-id="0462066344-25">[</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w">  </span><span class="mf">1.0</span><span class="p" data-group-id="0462066344-25">]</span><span class="p" data-group-id="0462066344-24">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="0462066344-26">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="0462066344-26">}</span><span class="p" data-group-id="0462066344-23">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">y_pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="0462066344-27">(</span><span class="p" data-group-id="0462066344-28">[</span><span class="p" data-group-id="0462066344-29">[</span><span class="mf">0.2953</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.1709</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9486</span><span class="p" data-group-id="0462066344-29">]</span><span class="p" data-group-id="0462066344-28">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="0462066344-30">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="0462066344-30">}</span><span class="p" data-group-id="0462066344-27">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon.Losses</span><span class="o">.</span><span class="n">soft_margin</span><span class="p" data-group-id="0462066344-31">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p">,</span><span class="w"> </span><span class="ss">reduction</span><span class="p">:</span><span class="w"> </span><span class="ss">:sum</span><span class="p" data-group-id="0462066344-31">)</span><span class="w">
</span><span class="p" data-group-id="0462066344-32">#</span><span class="nc" data-group-id="0462066344-32">Nx.Tensor</span><span class="p" data-group-id="0462066344-32">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="w">
  </span><span class="mf">1.9612486362457275</span><span class="w">
</span><span class="p" data-group-id="0462066344-32">&gt;</span></code></pre>
  </section>
</section>

          </div>
        </section>

      <footer class="footer">

        <p>
          <span class="line">
            Built using
            <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener">ExDoc</a> (v0.25.3) for the
            <a href="https://elixir-lang.org" title="Elixir" target="_blank">Elixir programming language</a>.
          </span>
          <span class="line">
            Designed by
            <a href="https://twitter.com/dignifiedquire" target="_blank" rel="noopener" title="@dignifiedquire">Friedel Ziegelmayer</a>.
          </span>
        </p>
        <p>

            <a href="api-reference.html" title="API reference" class="line footer-button">API Reference</a>

          <button class="line footer-button display-shortcuts-help">
            Display keyboard shortcuts
          </button>
          <button class="line footer-button night-mode-toggle">
            Toggle night mode
          </button>
          <button class="line footer-button display-quick-switch">
            Go to a HexDocs package
          </button>
          <button class="line footer-button tooltips-toggle">
            <span class="tooltips-option-disable">Disable tooltips</span>
            <span class="tooltips-option-enable">Enable tooltips</span>
          </button>
        </p>
      </footer>
    </div>
  </div>
</section>
</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css" integrity="sha384-t5CR+zwDAROtph0PXGte6ia8heboACF9R5l/DiY+WZ3P2lxNgvJkQk5n7GPvLMYw" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js" integrity="sha384-FaFLTlohFghEIZkw6VGwmf9ISTubWAVYW8tG8+w2LAIftJEULZABrF9PPFv+tVkH" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/contrib/auto-render.min.js" integrity="sha384-bHBqxz8fokvgoJ/sc17HODNxa42TlaEhB+w8ZJXTc2nZf1VgEaFZeZvT4Mznfz0v" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>

  </body>
</html>
